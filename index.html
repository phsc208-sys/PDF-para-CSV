<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrator PDF para Excel</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2>Extrator PDF -> Excel (MÃºltiplas Abas)</h2>
        <div id="contadorPlanilhas" style="background:#2ecc71; color:white; padding:5px 10px; border-radius:4px; font-weight:bold; display:none;">
            0 Planilhas Salvas
        </div>
    </div>
    
    <div class="controls">
        <div class="group">
            <button class="btn-blue" onclick="document.getElementById('pdfInput').click()">1. Carregar PDF</button>
            <input type="file" id="pdfInput" accept=".pdf" style="display: none" onchange="carregarPDF(this)">
        </div>

        <div class="group">
            <button id="btnTop" class="btn-tool" onclick="ativarModo('top')">InÃ­cio</button>
            <button id="btnBottom" class="btn-tool" onclick="ativarModo('bottom')">Fim</button>
        </div>

        <div class="group">
            <div class="slider-container">
                <div class="slider-label"><span>Altura Linha</span> <span id="tolVal">10px</span></div>
                <input type="range" id="tolerancia" min="2" max="50" value="10" oninput="recalcularLinhas()">
            </div>
            <div class="checkbox-wrapper">
                <div class="checkbox-item">
                    <input type="checkbox" id="checkColar" checked>
                    <label for="checkColar">Colar Quebras</label>
                </div>
            </div>
        </div>

        <div class="group">
            <button class="btn-nav" onclick="mudarPag(-1)">â—€</button>
            <span id="pagInfo" style="font-weight:bold; font-size:13px;">--/--</span>
            <button class="btn-nav" onclick="mudarPag(1)">â–¶</button>
        </div>

        <div class="group no-border">
            <button class="btn-orange" onclick="salvarPlanilhaAtual()">âž• Salvar Planilha</button>
            <button class="btn-red" onclick="limparTudo()">Limpar</button>
            <button class="btn-csv" onclick="baixarXLSX()">ðŸ“¥ Baixar Excel</button>
        </div>
    </div>

    <div id="workspace" onclick="cliqueWorkspace(event)">
        <div id="msgInicial">O PDF aparecerÃ¡ aqui...</div>
        </div>

    <div id="previewDiv" class="preview-area">
        <h3>PrÃ©-visualizaÃ§Ã£o Atual:</h3>
        <div class="scroll-table">
            <table id="tabelaDados">
                <thead><tr id="tabelaHeader"></tr></thead>
                <tbody id="tabelaBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script src="js/globals.js"></script>
<script src="js/ui.js"></script>
<script src="js/loader.js"></script>
<script src="js/processor.js"></script>

</body>
</html>